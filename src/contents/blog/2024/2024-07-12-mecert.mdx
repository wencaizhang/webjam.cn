---
title: ä½¿ç”¨ Mkcert è½»æ¾åˆ›å»ºæœ¬åœ°å¼€å‘ç¯å¢ƒçš„ HTTPS è¯ä¹¦
slug: mkcert-local-https-certificates
summary: Mkcert æ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨çš„å·¥å…·ï¼Œå¯ä»¥ä¸ºæœ¬åœ°å¼€å‘ç¯å¢ƒåˆ›å»ºå¯ä¿¡çš„ HTTPS è¯ä¹¦ï¼Œæ— éœ€å¤æ‚é…ç½®ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿåœ¨æœ¬åœ°æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒçš„ HTTPS è¿æ¥ã€‚
date: '2024-07-12'
featured: true
tags:
  - Mkcert
  - HTTPS
  - å¼€å‘å·¥å…·
  - æœ¬åœ°è¯ä¹¦
  - å®‰å…¨å¼€å‘
draft: false
featured_image_url: https://static.webjam.cn/images/202505/https.webp
---

## ä»€ä¹ˆæ˜¯ Mkcertï¼Ÿ

[Mkcert](https://github.com/FiloSottile/mkcert) æ˜¯ä¸€ä¸ªé›¶é…ç½®çš„å·¥å…·ï¼Œç”¨äºåœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­åˆ›å»ºå’Œå®‰è£…å¯ä¿¡çš„ HTTPS è¯ä¹¦ã€‚åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œè®¸å¤š API å’ŒåŠŸèƒ½ï¼ˆå¦‚åœ°ç†ä½ç½®ã€æ¨é€é€šçŸ¥ã€PWA ç­‰ï¼‰éƒ½è¦æ±‚ç½‘ç«™é€šè¿‡ HTTPS æä¾›æœåŠ¡ã€‚è€Œåœ¨å¼€å‘é˜¶æ®µï¼Œæˆ‘ä»¬é€šå¸¸åœ¨æœ¬åœ°ç¯å¢ƒï¼ˆlocalhostï¼‰å·¥ä½œï¼Œé…ç½®çœŸå®çš„ HTTPS è¯ä¹¦å¯èƒ½æ¯”è¾ƒéº»çƒ¦ã€‚

![](https://static.webjam.cn/images/202505/https.webp)

Mkcert è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥ï¼š

- åˆ›å»ºæœ¬åœ°ä¿¡ä»»çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰
- ç”Ÿæˆç”±è¯¥ CA ç­¾åçš„è¯ä¹¦
- è‡ªåŠ¨å°† CA æ·»åŠ åˆ°ç³»ç»Ÿå’Œæµè§ˆå™¨çš„ä¿¡ä»»å­˜å‚¨ä¸­
- æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨

è¿™æ ·ï¼Œæ‚¨å°±å¯ä»¥åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ HTTPSï¼Œè€Œä¸ä¼šé‡åˆ°æµè§ˆå™¨è­¦å‘Šæˆ–å®‰å…¨é”™è¯¯ã€‚

## å®‰è£… Mkcert

### macOS ç³»ç»Ÿ

macOS ç³»ç»Ÿå¯ä»¥ä½¿ç”¨ Homebrew å®‰è£…ï¼š

```bash
brew install mkcert
brew install nss # å¦‚æœéœ€è¦åœ¨ Firefox æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œéœ€è¦é¢å¤–å®‰è£… nss
```

### Windows ç³»ç»Ÿ

Windows ç³»ç»Ÿæœ‰å¤šç§å®‰è£…æ–¹å¼ï¼š

1. ä½¿ç”¨ [Chocolatey](https://chocolatey.org/) åŒ…ç®¡ç†å™¨ï¼š

```bash
choco install mkcert
```

2. ä½¿ç”¨ [Scoop](https://scoop.sh/) åŒ…ç®¡ç†å™¨ï¼š

```bash
scoop bucket add extras
scoop install mkcert
```

3. ç›´æ¥ä» GitHub ä¸‹è½½é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š[https://github.com/FiloSottile/mkcert/releases](https://github.com/FiloSottile/mkcert/releases)

### Linux ç³»ç»Ÿ

å¯¹äº Debian/Ubuntu ç³»ç»Ÿï¼š

```bash
apt install libnss3-tools
wget -O mkcert https://github.com/FiloSottile/mkcert/releases/download/v1.4.4/mkcert-v1.4.4-linux-amd64
chmod +x mkcert
sudo mv mkcert /usr/local/bin/
```

å¯¹äº CentOS/RHEL ç³»ç»Ÿï¼š

```bash
yum install nss-tools
wget -O mkcert https://github.com/FiloSottile/mkcert/releases/download/v1.4.4/mkcert-v1.4.4-linux-amd64
chmod +x mkcert
sudo mv mkcert /usr/local/bin/
```

## ä½¿ç”¨ Mkcert åˆ›å»ºè¯ä¹¦

### å®‰è£…æ ¹è¯ä¹¦

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…æœ¬åœ°æ ¹è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ã€‚è¿™ä¸€æ­¥åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ï¼Œå®ƒä¼šåœ¨æ‚¨çš„ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªå—ä¿¡ä»»çš„ CAï¼š

```bash
$ mkcert -install
Created a new local CA ğŸ’¥
The local CA is now installed in the system trust store! âš¡ï¸
The local CA is now installed in the Firefox trust store (requires browser restart)! ğŸ¦Š
```

å®‰è£…å®Œæˆåï¼Œæ‚¨éœ€è¦é‡å¯æµè§ˆå™¨ä»¥ç¡®ä¿æ›´æ”¹ç”Ÿæ•ˆï¼Œç‰¹åˆ«æ˜¯å¯¹äº Firefox æµè§ˆå™¨ã€‚

### åˆ›å»ºè¯ä¹¦

å»ºè®®åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„ç›®å½•æ¥å­˜å‚¨æ‚¨çš„è¯ä¹¦ï¼Œä»¥ä¾¿äºç®¡ç†ï¼š

```bash
mkdir -p ~/.local/share/mkcert
cd ~/.local/share/mkcert
```

#### ä¸ºå•ä¸ªåŸŸååˆ›å»ºè¯ä¹¦

æœ€ç®€å•çš„ç”¨æ³•æ˜¯ä¸º localhost åˆ›å»ºè¯ä¹¦ï¼š

```bash
mkcert localhost
```

è¿™å°†ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š
- `localhost.pem`ï¼ˆè¯ä¹¦æ–‡ä»¶ï¼‰
- `localhost-key.pem`ï¼ˆç§é’¥æ–‡ä»¶ï¼‰

#### ä¸ºå¤šä¸ªåŸŸååˆ›å»ºè¯ä¹¦

æ‚¨ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªè¯ä¹¦ä¸­åŒ…å«å¤šä¸ªåŸŸåæˆ– IP åœ°å€ï¼š

```bash
mkcert example.com "*.example.com" localhost 127.0.0.1 ::1
```

è¿™å°†åˆ›å»ºä¸€ä¸ªåŒæ—¶é€‚ç”¨äº example.comã€æ‰€æœ‰ example.com å­åŸŸåã€localhost ä»¥åŠ IPv4 å’Œ IPv6 æœ¬åœ°åœ°å€çš„è¯ä¹¦ã€‚

#### æŒ‡å®šè¾“å‡ºæ–‡ä»¶å

æ‚¨å¯ä»¥ä½¿ç”¨ `-cert-file` å’Œ `-key-file` å‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ï¼š

```bash
mkcert -cert-file cert.pem -key-file key.pem example.com
```

### åœ¨å¼€å‘æœåŠ¡å™¨ä¸­ä½¿ç”¨è¯ä¹¦

#### Node.js

```javascript
const https = require('https');
const fs = require('fs');
const express = require('express');

const app = express();
app.get('/', (req, res) => {
  res.send('Hello HTTPS!');
});

const server = https.createServer({
  key: fs.readFileSync('path/to/key.pem'),
  cert: fs.readFileSync('path/to/cert.pem')
}, app);

server.listen(3000, () => {
  console.log('HTTPS server running on https://localhost:3000');
});
```

#### Webpack Dev Server

åœ¨ webpack.config.js ä¸­ï¼š

```javascript
module.exports = {
  // ...å…¶ä»–é…ç½®
  devServer: {
    https: {
      key: fs.readFileSync('path/to/key.pem'),
      cert: fs.readFileSync('path/to/cert.pem'),
    }
  }
};
```

#### Vite

åœ¨ vite.config.js ä¸­ï¼š

```javascript
import fs from 'fs';

export default {
  server: {
    https: {
      key: fs.readFileSync('path/to/key.pem'),
      cert: fs.readFileSync('path/to/cert.pem'),
    }
  }
}
```
### åœ¨éƒ¨ç½²æœåŠ¡å™¨ä¸­ä½¿ç”¨è¯ä¹¦

#### Nginx

åœ¨ Nginx é…ç½®æ–‡ä»¶ä¸­ï¼ˆé€šå¸¸æ˜¯ `/etc/nginx/conf.d/default.conf` æˆ– `/etc/nginx/sites-available/default`ï¼‰ï¼š

```nginx
server {
    listen 443 ssl;
    server_name localhost;

    ssl_certificate     /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    # æ¨èçš„ SSL é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384;

    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }
}

# å¯é€‰ï¼šå°† HTTP é‡å®šå‘åˆ° HTTPS
server {
    listen 80;
    server_name localhost;
    return 301 https://$host$request_uri;
}
```

é‡æ–°åŠ è½½ Nginx é…ç½®ï¼š

```bash
sudo nginx -t       # æµ‹è¯•é…ç½®æ˜¯å¦æœ‰æ•ˆ
sudo nginx -s reload  # é‡æ–°åŠ è½½é…ç½®
```

#### Caddy

Caddy æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ Web æœåŠ¡å™¨ï¼Œå®ƒé»˜è®¤å¯ç”¨ HTTPS å¹¶è‡ªåŠ¨ç®¡ç†è¯ä¹¦ã€‚ä½¿ç”¨ mkcert ç”Ÿæˆçš„è¯ä¹¦éå¸¸ç®€å•ï¼š

åˆ›å»ºä¸€ä¸ª `Caddyfile`ï¼š

```
localhost {
    tls /path/to/cert.pem /path/to/key.pem

    # é™æ€æ–‡ä»¶æœåŠ¡
    root * /path/to/your/site
    file_server

    # æˆ–è€…åå‘ä»£ç†
    # reverse_proxy localhost:3000
}
```

å¯åŠ¨ Caddyï¼š

```bash
caddy run
```

Caddy çš„ä¼˜åŠ¿åœ¨äºé…ç½®éå¸¸ç®€æ´ï¼Œå¹¶ä¸”å®ƒä¼šè‡ªåŠ¨å¤„ç† HTTP åˆ° HTTPS çš„é‡å®šå‘ã€‚

## å¸¸è§é—®é¢˜

### è¯ä¹¦è¿‡æœŸæ€ä¹ˆåŠï¼Ÿ

Mkcert ç”Ÿæˆçš„è¯ä¹¦é»˜è®¤æœ‰æ•ˆæœŸä¸º 825 å¤©ã€‚å½“è¯ä¹¦è¿‡æœŸæ—¶ï¼Œåªéœ€é‡æ–°è¿è¡Œç›¸åŒçš„å‘½ä»¤æ¥ç”Ÿæˆæ–°è¯ä¹¦å³å¯ã€‚

### å¦‚ä½•æŸ¥çœ‹æ ¹è¯ä¹¦çš„ä½ç½®ï¼Ÿ

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ ¹è¯ä¹¦çš„ä½ç½®ï¼š

```bash
mkcert -CAROOT
```

### å¦‚ä½•å¸è½½æ ¹è¯ä¹¦ï¼Ÿ

å¦‚æœæ‚¨ä¸å†éœ€è¦ mkcert åˆ›å»ºçš„æ ¹è¯ä¹¦ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¸è½½ï¼š

```bash
mkcert -uninstall
```

### åœ¨ Docker å®¹å™¨ä¸­ä½¿ç”¨ mkcert è¯ä¹¦ï¼Ÿ

å¦‚æœæ‚¨åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œåº”ç”¨ç¨‹åºï¼Œéœ€è¦å°†è¯ä¹¦æ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œå¹¶ç¡®ä¿åº”ç”¨ç¨‹åºé…ç½®ä¸ºä½¿ç”¨è¿™äº›è¯ä¹¦ã€‚

## æ€»ç»“

Mkcert æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å¼€å‘å·¥å…·ï¼Œå®ƒè§£å†³äº†æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­é…ç½® HTTPS çš„ç—›ç‚¹ã€‚é€šè¿‡ç®€å•çš„å‡ ä¸ªå‘½ä»¤ï¼Œæ‚¨å°±å¯ä»¥ä¸ºæœ¬åœ°å¼€å‘ç¯å¢ƒåˆ›å»ºå¯ä¿¡çš„ HTTPS è¯ä¹¦ï¼Œæ‰€ä»¥è¯´æŒæ¡ Mkcert çš„ä½¿ç”¨æ˜¯ä¸€é¡¹éå¸¸æœ‰ä»·å€¼çš„æŠ€èƒ½ã€‚

## å‚è€ƒèµ„æ–™

- [Mkcert GitHub ä»“åº“](https://github.com/FiloSottile/mkcert)
- [Web å®‰å…¨ä¸Šä¸‹æ–‡ (MDN)](https://developer.mozilla.org/zh-CN/docs/Web/Security/Secure_Contexts)
- [HTTPS æœ¬åœ°å¼€å‘æœ€ä½³å®è·µ](https://web.dev/articles/how-to-use-local-https)
